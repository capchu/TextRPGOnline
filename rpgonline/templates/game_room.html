{% extends "base.html" %}
{% block body %}
    <div class="row">
        <div class="span12">
            <h1>Game Room  {{ session['game_id'] }}</h1>
            <div>
                {% if 'username' in session %}
                    <div>
                        <form class="form" id="create-form" method="post" action="/create_game">
                            Add Character:&nbsp;&nbsp;<input type="text" name="char_name" placeholder="character name">
                            <input type="text" name="user_name" placeholder="user who owns it">                         
                            &nbsp;&nbsp;<input type="submit" value="add">
                        </form>
                    </div>
                {% else %}
                    
                {% endif %}
            </div>
            <script type="text/javascript">
                $(document).ready(function() {
                        $.getJSON( '/game_room_json', { game_id: "{{ session['game_id'] }}" }, function( data ) {
                            var table_obj = $('#table');
                            $.each(data, function(index, field) {
                                $('#title').text('Games')
                                
                                var table_row = $('<tr>', {id: index});
                                var char_owner = $('<td>', {html: "<a href='"+game_ref+"'>join</a>"})
                                var char_name = $('<tr>', {id: name});
                                
                                var view_char= "/game/" + index
                                var view_character_link = $('<td>', {html: "<a href='"+game_ref+"'>join</a>"});
                                
                                var remove_char = "/game/" + index
                                var remove_character_link = $('<td>', {html: "<a href='"+game_ref+"'>join</a>"});
                                
                                var edit_char = "/game/" + index
                                var edit_character_link = $('<td>', {html: "<a href='"+game_ref+"'>join</a>"});
                                
                                table_row.append(char_owner);
                                table_row.append(view_character_link);
                                table_row.append(remove_character_link);
                                table_row.append(edit_character_link);
                                table_obj.append(table_row);
                            });
                            //console.log(JSON.stringify(data));
                        });
                });
            </script>
            
            <div id="characters">
                <style>
                    table, th, td {
                        
                    }
                    th, td {
                        padding:5px;
                    }
                </style>
                <table id="table" border="3" style="width:600px">
                    <tr>
                        <th colspan="12">
                            <h3 id="title"></h3>
                        </th>
                    </tr>
                    <tr>
                        <th>Name</th>
                        <th>Owner</th>
                        <th></th>
                    </tr>
                </table>
            </div>
            
        </div>
    </div>
{% endblock %}